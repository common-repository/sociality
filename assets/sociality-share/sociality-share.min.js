!function(){const{jQuery:t,location:e,socialityData:p}=window,o=t(document),i="sociality-share",r="https:"===e.protocol?"https:":"http:";function u(t,e){return function(t,e,p){return(t||"").replace(/\{([^}]+)\}/g,((t,o)=>o in e?p?p(e[o]):e[o]:t))}(t,e,encodeURIComponent)}const s={facebook:{popupUrl:"https://www.facebook.com/sharer.php?t={title}&u={url}",popupWidth:600,popupHeight:359},twitter:{counters:!1,popupUrl:"https://twitter.com/intent/tweet?text={text}&url={url}",popupWidth:670,popupHeight:350,click(){return/[.?:\-–—]\s*$/.test(this.options.title)||(this.options.title+=":"),!0}},pinterest:{counterUrl:"".concat(r,"//api.pinterest.com/v1/urls/count.json?url={url}&callback=?"),convertNumber(t){return t.count},popupUrl:"https://pinterest.com/pin/create/button/?url={url}&description={text}&media={media}",popupWidth:740,popupHeight:550},vkontakte:{counterUrl:"https://vk.com/share.php?act=count&url={url}&index={index}",counter(e,p){const o=s.vkontakte;o._||(o._=[],window.VK||(window.VK={}),window.VK.Share={count(t,e){o._[t].resolve(e)}});const i=o._.length;o._.push(p),t.getScript(u(e,{index:i})).fail(p.reject)},popupUrl:"https://vk.com/share.php?url={url}&title={title}&comment={excerpt}",popupWidth:655,popupHeight:450},odnoklassniki:{counterUrl:"".concat(r,"//connect.ok.ru/dk?st.cmd=extLike&ref={url}&uid={index}"),counter(e,p){const o=s.odnoklassniki;o._||(o._=[],window.ODKL||(window.ODKL={}),window.ODKL.updateCount=function(t,e){o._[t].resolve(e)});const i=o._.length;o._.push(p),t.getScript(u(e,{index:i})).fail(p.reject)},popupUrl:"https://connect.ok.ru/offer?url={url}",popupWidth:580,popupHeight:336},mailru:{counterUrl:"".concat(r,"//connect.mail.ru/share_count?url_list={url}&callback=1&func=?"),convertNumber(t){let e="";return Object.keys(t).forEach((p=>{!e&&t[p]&&t[p].shares&&(e=t[p].shares)})),e},popupUrl:"https://connect.mail.ru/share?share_url={url}&title={title}",popupWidth:492,popupHeight:500},linkedin:{popupUrl:"https://www.linkedin.com/shareArticle?title={title}&url={url}&summary={excerpt}&mini=true",popupWidth:500,popupHeight:550},tumblr:{popupUrl:"https://www.tumblr.com/widgets/share/tool?canonicalUrl={url}&title={title}&caption={excerpt}&posttype=link",popupWidth:500,popupHeight:550},skype:{popupUrl:"https://web.skype.com/share?url={url}&text={text}",popupWidth:500,popupHeight:550},buffer:{popupUrl:"https://buffer.com/add?url={url}&text={text}",popupWidth:500,popupHeight:550},pocket:{popupUrl:"https://getpocket.com/save?url={url}",popupWidth:500,popupHeight:550},xing:{popupUrl:"https://www.xing.com/spi/shares/new?url={url}",popupWidth:500,popupHeight:550},reddit:{popupUrl:"https://www.reddit.com/submit?title={title}&url={url}",popupWidth:500,popupHeight:550},flipboard:{popupUrl:"https://share.flipboard.com/bookmarklet/popout?v=2&title={text}&url={url}",popupWidth:500,popupHeight:550},delicious:{popupUrl:"https://del.icio.us/post?url={url}&title={title}",popupWidth:500,popupHeight:550},amazon:{popupUrl:"https://www.amazon.com/gp/wishlist/static-add?u={url}&t={title}",popupWidth:500,popupHeight:550},digg:{popupUrl:"https://digg.com/submit?title={text}&url={url}",popupWidth:500,popupHeight:550},evernote:{popupUrl:"https://www.evernote.com/clip.action?url={url}&title={text}",popupWidth:500,popupHeight:550},blogger:{popupUrl:"https://www.blogger.com/blog-this.g?u={url}&n={title}&t={excerpt}",popupWidth:500,popupHeight:550},yahoo:{popupUrl:"https://compose.mail.yahoo.com/?body={text}%20{url}&subject={title}",popupWidth:500,popupHeight:550},whatsapp:{popupUrl:"https://api.whatsapp.com/send?text={text}%20{url}",popupWidth:500,popupHeight:550},viber:{popupUrl:"viber://forward?text={text}%20{url}",popupWidth:500,popupHeight:550},telegram:{popupUrl:"https://t.me/share/url?url={url}&text={text}",popupWidth:500,popupHeight:550},mix:{popupUrl:"https://mix.com/mixit?su=submit&url={url}",popupWidth:850,popupHeight:735},diaspora:{popupUrl:"https://share.diasporafoundation.org/?title={title}&url={url}",popupWidth:500,popupHeight:550},line:{popupUrl:"https://lineit.line.me/share/ui?url={url}&text={text}",popupWidth:500,popupHeight:550},renren:{popupUrl:"http://widget.renren.com/dialog/share?resourceUrl={url}&srcUrl={url}&title={title}&description={excerpt}",popupWidth:500,popupHeight:550},wechat:{popupUrl:"".concat(p.site_url,"?sociality_share_wechat=1&url={url}"),popupWidth:400,popupHeight:650},weibo:{popupUrl:"http://service.weibo.com/share/share.php?url={url}&title={title}",popupWidth:650,popupHeight:320},"tencent-weibo":{popupUrl:"http://v.t.qq.com/share/share.php?url={url}&title={title}",popupWidth:650,popupHeight:320},google_plus:{popupUrl:"https://plus.google.com/share?url={url}",popupWidth:500,popupHeight:550},stumbleupon:{popupUrl:"http://www.stumbleupon.com/submit?url={url}",popupWidth:500,popupHeight:550}},n={promises:{},fetch(e,p,o){n.promises[e]||(n.promises[e]={});const i=n.promises[e];if(!o.forceUpdate&&i[p])return i[p];const r=t.extend({},s[e],o),h=t.Deferred(),c=r.counterUrl&&u(r.counterUrl,{url:p});return c&&t.isFunction(r.counter)?r.counter(c,h):r.counterUrl?t.getJSON(c).done((e=>{try{let p=e;t.isFunction(r.convertNumber)&&(p=r.convertNumber(e)),h.resolve(p)}catch(t){h.reject()}})).fail(h.reject):h.reject(),i[p]=h.promise(),i[p]}};function h(e,p){this.widget=e,this.options=t.extend({},p),this.detectService(),this.service&&this.init()}function c(t,e){this.container=t,this.options=e,this.init()}h.prototype={init(){this.getPopupUrl=t.proxy(this.getPopupUrl,this),this.click=t.proxy(this.click,this),this.initCounter=t.proxy(this.initCounter,this),this.detectParams();const{options:e}=this;e.popupUrl&&this.widget.attr("href",this.getPopupUrl()),this.widget.on("click",this.click),setTimeout(this.initCounter,0)},update(e){t.extend(this.options,{forceUpdate:!1},e),this.widget.find(".".concat(i,"-counter")).html(""),this.initCounter()},detectService(){const e=this.widget.data("share");e&&(this.service=e,t.extend(this.options,s[e]))},detectParams(){const t=this.widget.data();if(t.counter){const e=parseInt(t.counter,10);Number.isNaN(e)?this.options.counterUrl=t.counter:this.options.counterNumber=e}t.title&&(this.options.title=t.title),t.url&&(this.options.url=t.url),t.media&&(this.options.media=t.media),t.excerpt&&(this.options.excerpt=t.excerpt),t.text&&(this.options.text=t.text)},initCounter(){if(this.options.counters)if(this.options.counterNumber)this.updateCounter(this.options.counterNumber);else{const e={counterUrl:this.options.counterUrl,forceUpdate:this.options.forceUpdate};n.fetch(this.service,this.options.url,e).always(t.proxy(this.updateCounter,this))}},updateCounter(t){(t=parseInt(t,10)||0)||this.options.zeroes||(t=""),this.widget.find(".".concat(i,"-counter")).html(t),this.widget.trigger("counter.".concat(i),[this.service,t])},click(e){const{options:p}=this;let o=!0;return t.isFunction(p.click)&&(o=p.click.call(this,e)),o&&this.openPopup(this.getPopupUrl(),{width:p.popupWidth,height:p.popupHeight}),!1},getPopupUrl(){const{options:e}=this,p=u(e.popupUrl,{url:e.url,title:e.title,media:e.media,excerpt:e.excerpt,text:e.text}),o=t.param(t.extend(this.widget.data(),this.options.data));if(t.isEmptyObject(o))return p;const i=-1===p.indexOf("?")?"?":"&";return p+i+o},openPopup(p,o){const r=window.screenLeft,u=window.screenTop,s=window.innerWidth,n=window.innerHeight,h=Math.round(s/2-o.width/2)+r;let c=0;n>o.height&&(c=Math.round(n/3-o.height/2)+u);const l=window.open(p,"sl_".concat(this.service),"left=".concat(h,",top=").concat(c,",")+"width=".concat(o.width,",height=").concat(o.height,",personalbar=0,toolbar=0,scrollbars=1,resizable=1"));if(l){l.focus(),this.widget.trigger("popup_opened.".concat(i),[this.service,l]);const e=setInterval(t.proxy((function(){l.closed&&(clearInterval(e),this.widget.trigger("popup_closed.".concat(i),this.service))}),this),this.options.popupCheckInterval)}else e.href=p}},c.prototype={init(){this.countersLeft=0,this.number=0,this.container.on("counter.".concat(i),t.proxy(this.updateCounter,this));const e=this.container.find(".".concat(i,"-button"));this.buttons=[],e.each(t.proxy((function(e,p){const o=new h(t(p),this.options);this.buttons.push(o),o.options.counterUrl&&(this.countersLeft+=1)}),this)),this.options.counters&&(this.timeout=setTimeout(t.proxy(this.ready,this,!0),this.options.timeout))},update(e){if(e.forceUpdate||e.url!==this.options.url){this.number=0,this.countersLeft=this.buttons.length,this.widget&&this.widget.find(".".concat(i,"-counter")).html(""),t.extend(this.options,e);for(let t=0;t<this.buttons.length;t+=1)this.buttons[t].update(e)}},updateCounter(t,e,p){((p=p||0)||this.options.zeroes)&&(this.number+=p),this.countersLeft-=1,0===this.countersLeft&&this.ready()},ready(t){this.timeout&&clearTimeout(this.timeout),t||this.container.trigger("ready.".concat(i),this.number)}},t.fn.socialityShare=function(e){return this.each((function(){const p=t(this);let o=p.data(i);o?t.isPlainObject(e)&&o.update(e):(o=new c(p,t.extend({},t.fn.socialityShare.defaults,e,function(t){function e(t,e){return e.toUpper()}const p={},o=t.data();return Object.keys(o).forEach((t=>{let i=o[t];"yes"===i?i=!0:"no"===i&&(i=!1),p[t.replace(/-(\w)/g,e)]=i})),p}(p))),p.data(i,o))}))},t.fn.socialityShare.defaults={url:window.location.href.replace(window.location.hash,""),title:document.title,media:"",excerpt:"",text:"",counters:!0,zeroes:!1,timeout:1e4,popupCheckInterval:500},o.on("ready.".concat(i),(()=>{t(".".concat(i)).socialityShare()}))}();